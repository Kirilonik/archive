# Настройка среды разработки

Этот документ описывает настройку среды разработки для проекта Media Archive.

## Автоматическое форматирование

Проект настроен для автоматического форматирования кода при сохранении и перед коммитом.

### Настройки редактора (VS Code / Cursor)

Проект включает настройки для автоматического форматирования:

- **Форматирование при сохранении** - включено для всех файлов
- **Prettier** - используется как форматтер по умолчанию
- **ESLint** - автоматически исправляет ошибки при сохранении

Настройки находятся в `.vscode/settings.json` и применяются автоматически при открытии проекта.

### Рекомендуемые расширения

Установите рекомендуемые расширения для лучшего опыта разработки:

1. **Prettier - Code formatter** (`esbenp.prettier-vscode`)
   - Автоматическое форматирование кода

2. **ESLint** (`dbaeumer.vscode-eslint`)
   - Проверка и исправление ошибок линтинга

3. **EditorConfig for VS Code** (`editorconfig.editorconfig`)
   - Поддержка единых настроек редактора

VS Code/Cursor автоматически предложит установить эти расширения при открытии проекта.

### Pre-commit hooks

Проект использует **Husky** и **lint-staged** для автоматического форматирования перед коммитом:

- При каждом коммите автоматически запускается `lint-staged`
- Измененные файлы автоматически форматируются с помощью Prettier
- ESLint автоматически исправляет ошибки
- Если форматирование или линтинг не проходят, коммит блокируется

Это гарантирует, что весь код в репозитории соответствует стандартам форматирования.

### Ручное форматирование

Если нужно отформатировать весь проект вручную:

```bash
npm run format
```

Для проверки форматирования без изменений:

```bash
npm run format:check
```

## Настройка с нуля

### 1. Установка зависимостей

```bash
npm install
```

### 2. Настройка Husky (автоматически)

Husky настраивается автоматически при установке зависимостей через скрипт `prepare` в `package.json`.

### 3. Установка расширений VS Code/Cursor

1. Откройте проект в VS Code/Cursor
2. Нажмите `Cmd+Shift+P` (Mac) или `Ctrl+Shift+P` (Windows/Linux)
3. Введите "Extensions: Show Recommended Extensions"
4. Установите все рекомендуемые расширения

Или установите вручную через Marketplace:

- Prettier - Code formatter
- ESLint
- EditorConfig for VS Code

### 4. Проверка настройки

Создайте тестовый файл и сохраните его - он должен автоматически отформатироваться.

## Как это работает

### При сохранении файла

1. EditorConfig применяет базовые настройки (отступы, окончания строк)
2. Prettier форматирует код согласно `.prettierrc.json`
3. ESLint проверяет и исправляет ошибки линтинга

### При коммите

1. Husky запускает pre-commit hook
2. lint-staged находит измененные файлы
3. Prettier форматирует измененные файлы
4. ESLint исправляет ошибки в измененных файлах
5. Если все проверки пройдены, коммит выполняется
6. Если есть ошибки, коммит блокируется с сообщением об ошибке

## Решение проблем

### Форматирование не работает при сохранении

1. Убедитесь, что установлено расширение Prettier
2. Проверьте, что в настройках VS Code/Cursor включено `editor.formatOnSave`
3. Убедитесь, что Prettier выбран как форматтер по умолчанию

### Pre-commit hook не работает

1. Убедитесь, что Husky установлен: `npm list husky`
2. Проверьте, что `.husky/pre-commit` существует и имеет права на выполнение
3. Переустановите Husky: `npx husky install`

### Конфликты форматирования

Если возникают конфликты форматирования:

1. Запустите `npm run format` для форматирования всего проекта
2. Убедитесь, что все используют одинаковую версию Prettier
3. Проверьте, что `.prettierrc.json` одинаков для всех

## Дополнительная информация

- [Prettier документация](https://prettier.io/docs/en/)
- [ESLint документация](https://eslint.org/docs/latest/)
- [Husky документация](https://typicode.github.io/husky/)
- [EditorConfig документация](https://editorconfig.org/)
