# –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ Media Archive

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2025-11-16  
**–í–µ—Ä—Å–∏—è:** 1.0

## üìä –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: **9.5/10** (–û—Ç–ª–∏—á–Ω–æ)

–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç –æ—Ç–ª–∏—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –∑–∞—â–∏—Ç—ã –æ—Ç –æ—Å–Ω–æ–≤–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π. –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä—ã –∑–∞—â–∏—Ç—ã.

---

## ‚úÖ –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. –ó–∞—â–∏—Ç–∞ –æ—Ç SQL Injection ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
- **–°—Ç–∞—Ç—É—Å:** –û—Ç–ª–∏—á–Ω–æ –∑–∞—â–∏—â–µ–Ω–æ
- **–î–µ—Ç–∞–ª–∏:** –í—Å–µ SQL –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ `$1, $2, ...`
- **–ü—Ä–∏–º–µ—Ä—ã:**
  ```typescript
  // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ - –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
  pool.query('SELECT * FROM users WHERE email = $1', [email])
  ```
- **–§–∞–π–ª—ã:** –í—Å–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—é

### 2. –ó–∞—â–∏—Ç–∞ –æ—Ç XSS (Cross-Site Scripting) ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
- **–°—Ç–∞—Ç—É—Å:** –•–æ—Ä–æ—à–æ –∑–∞—â–∏—â–µ–Ω–æ
- **–î–µ—Ç–∞–ª–∏:**
  - Markdown –∫–æ–Ω—Ç–µ–Ω—Ç —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `rehype-sanitize`
  - CSP (Content Security Policy) –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `'strict-dynamic'` –≤–º–µ—Å—Ç–æ `'unsafe-inline'` –¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤
- **–§–∞–π–ª—ã:**
  - `client/src/components/MarkdownEditor.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `rehypeSanitize`
  - `server/src/index.ts` - CSP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### 3. CSRF (Cross-Site Request Forgery) –∑–∞—â–∏—Ç–∞ ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
- **–°—Ç–∞—Ç—É—Å:** –û—Ç–ª–∏—á–Ω–æ –∑–∞—â–∏—â–µ–Ω–æ
- **–î–µ—Ç–∞–ª–∏:**
  - CSRF —Ç–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `httpOnly` cookie (–Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ JavaScript)
  - –¢–æ–∫–µ–Ω –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ (POST, PUT, DELETE)
  - –û—Ç–¥–µ–ª—å–Ω—ã–π endpoint `/api/csrf-token` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞
- **–§–∞–π–ª—ã:**
  - `server/src/middlewares/csrf.ts`

### 4. Origin Validation ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
- **–°—Ç–∞—Ç—É—Å:** –û—Ç–ª–∏—á–Ω–æ –∑–∞—â–∏—â–µ–Ω–æ
- **–î–µ—Ç–∞–ª–∏:**
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ `Origin` –∏ `Referer` –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
  - –î–ª—è –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–π origin
  - –ó–∞–ø—Ä–æ—Å—ã –±–µ–∑ origin/referer –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è
- **–§–∞–π–ª—ã:**
  - `server/src/middlewares/origin.ts`

### 5. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è ‚≠ê‚≠ê‚≠ê‚≠ê
- **–°—Ç–∞—Ç—É—Å:** –•–æ—Ä–æ—à–æ –∑–∞—â–∏—â–µ–Ω–æ
- **–î–µ—Ç–∞–ª–∏:**
  - –ü–∞—Ä–æ–ª–∏ —Ö—ç—à–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `bcrypt` —Å 10 —Ä–∞—É–Ω–¥–∞–º–∏
  - JWT —Ç–æ–∫–µ–Ω—ã —Å —Ä–∞–∑–¥–µ–ª—å–Ω—ã–º–∏ —Å–µ–∫—Ä–µ—Ç–∞–º–∏ –¥–ª—è access –∏ refresh
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ä–≤–∏—Å–æ–≤ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ)
  - Google OAuth —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π —Ç–æ–∫–µ–Ω–æ–≤
- **–§–∞–π–ª—ã:**
  - `server/src/infrastructure/security/bcrypt-password-hasher.ts`
  - `server/src/middlewares/auth.ts`
  - `server/src/application/auth/auth.service.ts`

### 6. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
- **–°—Ç–∞—Ç—É—Å:** –û—Ç–ª–∏—á–Ω–æ –∑–∞—â–∏—â–µ–Ω–æ
- **–î–µ—Ç–∞–ª–∏:**
  - –í—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ Zod —Å—Ö–µ–º—ã
  - URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞)
  - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö (10mb –¥–ª—è JSON)
- **–§–∞–π–ª—ã:**
  - `server/src/app/validators/` - –≤—Å–µ —Å—Ö–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
  - `server/src/app/validators/params.schema.ts` - –≤–∞–ª–∏–¥–∞—Ü–∏—è ID

### 7. Rate Limiting ‚≠ê‚≠ê‚≠ê‚≠ê
- **–°—Ç–∞—Ç—É—Å:** –•–æ—Ä–æ—à–æ –∑–∞—â–∏—â–µ–Ω–æ
- **–î–µ—Ç–∞–ª–∏:**
  - –†–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤:
    - Auth: 10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
    - General: 100 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
    - Write: 30 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
    - Search: 50 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
- **–§–∞–π–ª—ã:**
  - `server/src/middlewares/rate-limiters.ts`

### 8. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ ‚≠ê‚≠ê‚≠ê‚≠ê
- **–°—Ç–∞—Ç—É—Å:** –•–æ—Ä–æ—à–æ –∑–∞—â–∏—â–µ–Ω–æ
- **–î–µ—Ç–∞–ª–∏:**
  - –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—é—Ç—Å—è –¥–µ—Ç–∞–ª–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –æ—à–∏–±–æ–∫
  - –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
  - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã
- **–§–∞–π–ª—ã:**
  - `server/src/middlewares/error.ts`

### 9. HTTP Security Headers ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
- **–°—Ç–∞—Ç—É—Å:** –û—Ç–ª–∏—á–Ω–æ –∑–∞—â–∏—â–µ–Ω–æ
- **–î–µ—Ç–∞–ª–∏:**
  - Helmet –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
  - HSTS –≤–∫–ª—é—á–µ–Ω –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
  - CSP –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å—Ç—Ä–æ–≥–æ
  - CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å whitelist origins
- **–§–∞–π–ª—ã:**
  - `server/src/index.ts`

### 10. –ó–∞—â–∏—Ç–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ ‚≠ê‚≠ê‚≠ê‚≠ê
- **–°—Ç–∞—Ç—É—Å:** –•–æ—Ä–æ—à–æ –∑–∞—â–∏—â–µ–Ω–æ
- **–î–µ—Ç–∞–ª–∏:**
  - –í–∞–ª–∏–¥–∞—Ü–∏—è JWT —Å–µ–∫—Ä–µ—Ç–æ–≤ (–º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ)
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
  - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ Zod –≤–∞–ª–∏–¥–∞—Ü–∏—é
- **–§–∞–π–ª—ã:**
  - `server/src/config/env.ts`

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –ó–∞—â–∏—Ç–∞ –æ—Ç Timing Attacks ‚úÖ
- **–°—Ç–∞—Ç—É—Å:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–†–µ—à–µ–Ω–∏–µ:** –í—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω
- **–§–∞–π–ª—ã:** 
  - `server/src/infrastructure/security/bcrypt-password-hasher.ts`
  - `server/src/application/auth/auth.service.ts`

### 2. –ü–æ–ª–∏—Ç–∏–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª–µ–π ‚úÖ
- **–°—Ç–∞—Ç—É—Å:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
  - –ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤
  - –•–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∑–∞–≥–ª–∞–≤–Ω–∞—è –±—É–∫–≤–∞
  - –•–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Å—Ç—Ä–æ—á–Ω–∞—è –±—É–∫–≤–∞
  - –•–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Ü–∏—Ñ—Ä–∞
- **–§–∞–π–ª:** `server/src/app/controllers/auth.controller.ts`

### 3. Rate Limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ IP ‚úÖ
- **–°—Ç–∞—Ç—É—Å:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω `ipRateLimiter` - 200 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É —Å –æ–¥–Ω–æ–≥–æ IP
- **–§–∞–π–ª:** `server/src/middlewares/rate-limiters.ts`

### 4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ ‚úÖ
- **–°—Ç–∞—Ç—É—Å:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–†–µ—à–µ–Ω–∏–µ:** –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
  - –ù–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
  - –ü–æ–ø—ã—Ç–æ–∫ –¥–æ—Å—Ç—É–ø–∞ –∫ —á—É–∂–∏–º –¥–∞–Ω–Ω—ã–º
  - –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (XSS, SQL injection, path traversal)
- **–§–∞–π–ª:** `server/src/middlewares/security-logger.ts`

### 5. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ Security Headers ‚úÖ
- **–°—Ç–∞—Ç—É—Å:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–î–æ–±–∞–≤–ª–µ–Ω–æ:**
  - `Referrer-Policy: strict-origin-when-cross-origin`
  - `X-Content-Type-Options: nosniff`
  - `X-Frame-Options: DENY`
  - `X-DNS-Prefetch-Control: on`
  - `X-Download-Options: noopen`
- **–§–∞–π–ª:** `server/src/index.ts`

## ‚ö†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 1. 2FA (–î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è) (–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ñ–∞–∫—Ç–æ—Ä–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é 2FA —á–µ—Ä–µ–∑ TOTP
- **–°—Ç–∞—Ç—É—Å:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 2. Session Management (–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –æ—Ç–∑—ã–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤ (blacklist)
- **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å blacklist –¥–ª—è –æ—Ç–æ–∑–≤–∞–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ (Redis –∏–ª–∏ –ë–î)
- **–°—Ç–∞—Ç—É—Å:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 3. –ó–∞—â–∏—Ç–∞ –æ—Ç Brute Force (–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
- **–ü—Ä–æ–±–ª–µ–º–∞:** Rate limiting –µ—Å—Ç—å, –Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—É—é –∑–∞—â–∏—Ç—É
- **–†–µ—à–µ–Ω–∏–µ:** 
  - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –ø–æ—Å–ª–µ N –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ (–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
  - CAPTCHA –ø–æ—Å–ª–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ø—ã—Ç–æ–∫
- **–°—Ç–∞—Ç—É—Å:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)

---

## üîí –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç `userId` –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ü–∏–π:

```typescript
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ - –ø—Ä–æ–≤–µ—Ä–∫–∞ userId
async updateFilm(userFilmId: number, input: FilmUpdateDto, userId?: number) {
  if (!userId) return null;
  const existing = await this.repository.getUserFilm(userFilmId, userId);
  if (!existing) return null; // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å —á—É–∂–æ–π —Ñ–∏–ª—å–º
  // ...
}
```

**–§–∞–π–ª—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π:**
- `server/src/application/films/film.service.ts`
- `server/src/application/series/series.service.ts`
- `server/src/app/controllers/users.controller.ts` - –ø—Ä–æ–≤–µ—Ä–∫–∞ `userId !== requestedId`

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞—Å–ø–µ–∫—Ç—ã
- [x] SQL Injection –∑–∞—â–∏—Ç–∞ (–ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã)
- [x] XSS –∑–∞—â–∏—Ç–∞ (—Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è, CSP)
- [x] CSRF –∑–∞—â–∏—Ç–∞ (—Ç–æ–∫–µ–Ω—ã, httpOnly cookies)
- [x] Origin validation
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (Zod)
- [x] –•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (bcrypt)
- [x] JWT —Ç–æ–∫–µ–Ω—ã (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
- [x] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞)
- [x] Rate limiting
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (–±–µ–∑ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –¥–µ—Ç–∞–ª–µ–π)

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- [x] –ó–∞—â–∏—Ç–∞ –æ—Ç timing attacks ‚úÖ
- [x] –ü–æ–ª–∏—Ç–∏–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª–µ–π ‚úÖ
- [x] Rate limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ IP ‚úÖ
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ ‚úÖ
- [x] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ security headers ‚úÖ
- [ ] Session management (blacklist —Ç–æ–∫–µ–Ω–æ–≤)
- [ ] –ó–∞—â–∏—Ç–∞ –æ—Ç brute force (CAPTCHA)
- [ ] 2FA (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

### –û–±—â–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: **9.5/10** ‚≠ê

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- –û—Ç–ª–∏—á–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –æ—Å–Ω–æ–≤–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π (SQL Injection, XSS, CSRF)
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –•–æ—Ä–æ—à–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ security headers
- **–ó–∞—â–∏—Ç–∞ –æ—Ç timing attacks** ‚úÖ
- **–ü–æ–ª–∏—Ç–∏–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª–µ–π** ‚úÖ
- **Rate limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ IP** ‚úÖ
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏** ‚úÖ

**–û–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
- Session management (blacklist —Ç–æ–∫–µ–Ω–æ–≤)
- –ë–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç brute force (CAPTCHA)
- 2FA (–¥–ª—è –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)

**–í—ã–≤–æ–¥:** –ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç –æ—Ç–ª–∏—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ. –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã. –û—Å—Ç–∞–≤—à–∏–µ—Å—è —É–ª—É—á—à–µ–Ω–∏—è —è–≤–ª—è—é—Ç—Å—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ –∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Node.js Security Best Practices](https://nodejs.org/en/docs/guides/security/)
- [Express Security Best Practices](https://expressjs.com/en/advanced/best-practice-security.html)

